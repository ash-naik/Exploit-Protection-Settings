# Windows 10 Exploit Protection Settings

## Applying exploit protection policies
The settings XML files found here can be applied via PowerShell with the
following commands (as admin):

  1. Verify that the file is valid:

    Set-ProcessMitigation -PolicyFilePath .\ExploitProtectionSettings.xml -IsValid

  2. Apply the policy:

    Set-ProcessMitigation -PolicyFilePath .\ExploitProtectionSettings.xml

Note that applying settings using this method will not remove existing
settings. However, existing settings that conflict with the applied settings
will be overwritten.

## Formatting XML files

### In PowerShell:

    $settings = Get-Content ./ExploitProtectionSettings.xml
    $settings -replace "([A-z`"]{1}) ([A-z]{1})", "$('$1')`n      $('$2')"

### In Sublime Text:
In regex replace mode, replace this:

    ([A-z"]{1}) ([A-z]{1})

With this:

    $1
          $2

## Glossary
| Component | XML | PowerShell | Exploit Protection App | Description |
|-----------|-----|------------|-----------------------|-------------|
| BinarySignature | AllowStoreSignedBinaries || Also allow loading of images signed by Microsoft Store ||
| BinarySignature | PreferSystem32 ||||
| Child Process | DisallowChildProcessCreation ||||
| SEHOP | Enable | Enable | Validate exception chains (SEHOP) | Enable SEHOP |
| SEHOP | TelemetryOnly ||||
|| AllowThreadsToOptOut ||| Allow threads to opt out of ACG |
|| BlockDynamicCode ||||
|| BlockLowLabelImageLoads || Block log integrity images ||
|| BlockRemoteImageLoads ||||
|| BottomUp || Randomize memory allocations (Bottom-up ASLR) ||
|| DisableExtensionPoints ||||
|| DisableNonSystemFonts ||||
|| DisableWin32kSystemCalls ||||
|| EmulateAtlThunks ||||
|| EnableExportAddressFilter || Export address filtering (EAF) ||
|| EnableExportAddressFilterPlus || Validate access for modules that are commonly abused by exploits. ||
|| EnableImportAddressFilter || Import address filtering (IAF) ||
|| EnableRopCallerCheck || Validate API invocation  (CallerCheck) ||
|| EnableRopSimExec || Simulate Execution (SimExec) ||
|| EnableRopStackPivot || Validate stack integrity (StackPivot) ||
|| EnforceModuleDependencySigning ||||
|| ForceRelocateImages || Force randomization for images (Mandatory ASLR) ||
|| HighEntropy ||| Use High Entropy ASLR |
|| MicrosoftSignedOnly || Code integrity guard ||
|| RequireInfo ||||
|| StrictControlFlowGuard ||||
|| SuppressExports ||||
|| TerminateOnError ||||
